<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" style="mc-template-page: url('../../Resources/MasterPages/OtherTopics.flmsp');">
    <head><title></title>
        <link href="../../Resources/Stylesheets/MainStyles.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <h1 id="azure-load-balancer">Azure Load Balancer</h1>
        <p>This topic explains how to use an Azure Load Balancer (Layer 4) for your Swimlane deployment.</p>
        <h2 id="architecture-diagram">Architecture Diagram</h2>
        <p>
            <img src="../../Resources/Images/azure-load-balancer-diagram.png" alt="" />
        </p>
        <h2 id="load-balancer">Load Balancer</h2>
        <ul>
            <li>Create a <a href="https://docs.microsoft.com/en-us/azure/load-balancer/quickstart-load-balancer-standard-public-portal" target="_blank_">Public Azure Load Balancer</a></li>
        </ul>
        <p class="important"><strong>Important! </strong><code>Type</code> must be set to <code>Public</code> because internal load balancers do not support hairpinning.</p>
        <p>Continue setup of the load balancer with the following settings:</p>
        <ul>
            <li><code>Resource Group</code> should be set according to your organization's standards</li>
            <li><code>Region</code> should match that of the Virtual Machines that Swimlane will be installed in</li>
            <li><code>Type</code> set to <code>Public</code><ul><li>This has to be set to Public because Internal load balancers do not support hairpinning</li><li>Access to the virtual machines should still be restricted by network security groups</li></ul></li>
            <li><code>SKU</code> set to <code>Standard</code></li>
            <li><code>Tier</code> set to<code>Regional</code></li>
            <li><code>Public IP Address</code> can either be a new Public IP Address to use or select an existing one</li>
            <li><code>Availability Zone</code> set to <code>Zone-redundant</code></li>
        </ul>
        <h2 id="backend-pools">Backend Pools</h2>
        <ul>
            <li>Create the following Backend Pools:
<ul><li>Port 443
<ul><li><code>Backend Pool Configuration</code> set to <code>NIC</code></li><li><code>IP Version</code> set to <code>IPv4</code></li><li><code>Virtual Machines</code><ul><li>Add the first virtual machine that you'll be running the Swimlane Platform Installer on to the backend pool
<ul><li>After Swimlane has been installed on the additional nodes they need to be added to this target group</li></ul></li></ul></li></ul></li><li>Port 8800
<ul><li><code>Backend Pool Configuration</code> set to <code>NIC</code></li><li><code>IP Version</code> set to <code>IPv4</code></li><li><code>Virtual Machines</code><ul><li>Add the first virtual machine that you'll be running the Swimlane Platform Installer on to the backend pool
<ul><li>After Swimlane has been installed on the additional nodes they need to be added to this target group</li></ul></li></ul></li></ul></li><li>Port 6443
<ul><li><code>Backend Pool Configuration</code> set to <code>NIC</code></li><li><code>IP Version</code> set to <code>IPv4</code></li><li><code>Virtual Machines</code><ul><li>Add the first virtual machine that you'll be running the Swimlane Platform Installer on to the backend pool
<ul><li>After Swimlane has been installed on the additional nodes they need to be added to this target group</li></ul></li></ul></li></ul></li><li>Optional - Port 80
<ul><li>Used for the HTTP to HTTPS redirect and can be excluded if you only want HTTPS/443 to be available</li><li><code>Backend Pool Configuration</code> set to <code>NIC</code></li><li><code>IP Version</code> set to <code>IPv4</code></li><li><code>Virtual Machines</code><ul><li>Add the first virtual machine that you'll be running the Swimlane Platform Installer on to the backend pool
<ul><li>After Swimlane has been installed on the additional nodes they need to be added to this target group</li></ul></li></ul></li></ul></li></ul></li>
        </ul>
        <h2 id="health-probes">Health Probes</h2>
        <ul>
            <li>Create the following Health Probes:
<ul><li>Port 443
<ul><li><code>Protocol</code> set to <code>TCP</code></li><li><code>Port</code> set to <code>443</code></li><li><code>Interval</code> and <code>Unhealthy Threshold</code> may vary based on your preferences for how quickly a virtual machine should become unhealthy in order to stop receiving traffic</li></ul></li><li>Port 8800
<ul><li><code>Protocol</code> set to <code>TCP</code></li><li><code>Port</code> set to <code>8800</code></li><li><code>Interval</code> and <code>Unhealthy Threshold</code> may vary based on your preferences for how quickly a virtual machine should become unhealthy in order to stop receiving traffic</li></ul></li><li>Port 6443
<ul><li><code>Protocol</code> set to <code>TCP</code></li><li><code>Port</code> set to <code>6443</code></li><li><code>Interval</code> and <code>Unhealthy Threshold</code> may vary based on your preferences for how quickly a virtual machine should become unhealthy in order to stop receiving traffic</li></ul></li><li>Optional - Port 80
<ul><li>Used for the HTTP to HTTPS redirect and can be excluded if you only want HTTPS/443 to be available</li><li><code>Protocol</code> set to <code>TCP</code></li><li><code>Port</code> set to <code>80</code></li><li><code>Interval</code> and <code>Unhealthy Threshold</code> may vary based on your preferences for how quickly a virtual machine should become unhealthy in order to stop receiving traffic</li></ul></li></ul></li>
        </ul>
        <h2 id="load-balancing-rules">Load Balancing Rules</h2>
        <ul>
            <li>Create the following Load Balancing Rules:
<ul><li>Port 443
<ul><li><code>IP Version</code> set to <code>IPv4</code></li><li><code>Frontend IP Address</code> set to the IP that was chosen when the load balancer was created</li><li><code>Protocol</code> set to <code>TCP</code></li><li><code>Port</code> set to <code>443</code></li><li><code>Backend Port</code> set to <code>443</code></li><li><code>Backend Pool</code> set to the <code>Port 443</code> backend pool created above</li><li><code>Health Probe</code> set to the <code>Port 443</code> health probe created above</li><li><code>Floating IP</code> set to <code>Disabled</code></li><li><code>Outbound Source Network Address Translation</code> set to <code>Outbound and inbound use the same IP</code></li></ul></li><li>Port 8800
<ul><li><code>IP Version</code> set to <code>IPv4</code></li><li><code>Frontend IP Address</code> set to the IP that was chosen when the load balancer was created</li><li><code>Protocol</code> set to <code>TCP</code></li><li><code>Port</code> set to <code>8800</code></li><li><code>Backend Port</code> set to <code>8800</code></li><li><code>Backend Pool</code> set to the <code>Port 8800</code> backend pool created above</li><li><code>Health Probe</code> set to the <code>Port 8800</code> health probe created above</li><li><code>Floating IP</code> set to <code>Disabled</code></li><li><code>Outbound Source Network Address Translation</code> set to <code>Outbound and inbound use the same IP</code></li></ul></li><li>Port 6443
<ul><li><code>IP Version</code> set to <code>IPv4</code></li><li><code>Frontend IP Address</code> set to the IP that was chosen when the load balancer was created</li><li><code>Protocol</code> set to <code>TCP</code></li><li><code>Port</code> set to <code>6443</code></li><li><code>Backend Port</code> set to <code>6443</code></li><li><code>Backend Pool</code> set to the <code>Port 6443</code> backend pool created above</li><li><code>Health Probe</code> set to the <code>Port 6443</code> health probe created above</li><li><code>Floating IP</code> set to <code>Disabled</code></li><li><code>Outbound Source Network Address Translation</code> set to <code>Outbound and inbound use the same IP</code></li></ul></li><li>Optional - Port 80
<ul><li><code>IP Version</code> set to <code>IPv4</code></li><li><code>Frontend IP Address</code> set to the IP that was chosen when the load balancer was created</li><li><code>Protocol</code> set to <code>TCP</code></li><li><code>Port</code> set to <code>80</code></li><li><code>Backend Port</code> set to <code>80</code></li><li><code>Backend Pool</code> set to the <code>Port 80</code> backend pool created above</li><li><code>Health Probe</code> set to the <code>Port 80</code> health probe created above</li><li><code>Floating IP</code> set to <code>Disabled</code></li><li><code>Outbound Source Network Address Translation</code> set to <code>Outbound and inbound use the same IP</code></li></ul></li></ul></li>
        </ul>
        <h2 id="network-security-groups">Network Security Groups</h2>
        <p>For Azure Load Balancers, ingress port access is defined in the Network Security groups used by the virtual machines and subnets. The port requirements are available in the  External Access section of the <a href="../system-requirements-for-an-embedded-cluster-install/system-requirements-for-an-embedded-cluster-install.htm">System Requirements for an Embedded Cluster Installation</a>.</p>
        <h2 id="swimlane-configuration">Swimlane Configuration</h2>
        <p>Be sure to enable the <code>Enable the Ingress Controller</code> option on the Swimlane Platform Installer UI config tab.</p>
    </body>
</html>