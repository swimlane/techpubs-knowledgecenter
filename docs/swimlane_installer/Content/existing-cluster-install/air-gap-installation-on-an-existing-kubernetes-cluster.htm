<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
    </head>
    <body>
        <h2>Air Gap Installation on an Existing Kubernetes Cluster</h2>
        <p>This topic walks through the process of installing Swimlane in an existing Kubernetes cluster that is air-gapped. Air gap refers to a system that resides in a private network, "air-gapped" from external networks or the internet.</p>
        <p>Swimlane provides the following:</p>
        <ul>
            <li>
                <p>The air gap bundle</p>
            </li>
            <li>
                <p>A KOTS application license (.yaml)</p>
            </li>
            <li>
                <p>A Swimlane license (.lic)</p>
            </li>
        </ul>
        <p>The airgap bundle contains the images and Kubernetes manifests for Swimlane. When it comes time to update your Swimlane version, you will need a new airgap bundle. Reach out to your Swimlane support representative for access to the new bundle.</p>
        <p>Before you begin you need:</p>
        <ul>
            <li>
                <p>The airgap bundle in a jumpbox that your Kubernetes cluster can pull from</p>
            </li>
            <li>
                <p>The KOTS kubectl addon version that is currently recommended by Swimlane</p>
            </li>
            <li>
                <p>A private image registry</p>
            </li>
        </ul>
        <p>Verify your environment meets Swimlane's <a href="system-requirements-for-an-existing-cluster-install/system-requirements-for-an-existing-cluster-install.htm">system requirements</a>.</p>
        <h2>Install KOTS Kubectl Add-on</h2>
        <ol>
            <li>
                <p>The current recommended KOTS version is available through these Swimlane links. Download the SPI kubectl add-on for the OS version of your jumpbox:</p>
            </li>
        </ol>
        <ol>
            <p>Linux: <a href="https://get.swimlane.io/existing-cluster/install/linux">https://get.swimlane.io/existing-cluster/install/linux</a><br /></p>
            <p>OSX: <a href="https://get.swimlane.io/existing-cluster/install/osx">https://get.swimlane.io/existing-cluster/install/osx</a><br /></p>
        </ol>
        <ol start="2" MadCap:continue="true">
            <li>Untar the file:</li>
            <MadCap:codeSnippet>
                <MadCap:codeSnippetCopyButton />
                <MadCap:codeSnippetBody MadCap:useLineNumbers="False" MadCap:lineNumberStart="1" MadCap:continue="False" xml:space="preserve">tar zxf kots_&lt;OS version&gt;.tar.gz</MadCap:codeSnippetBody>
            </MadCap:codeSnippet>
        </ol>
        <ol MadCap:continue="true">
            <li>Rename the <code>kots</code> binary to <code>kubectl-kots</code>:</li>
            <MadCap:codeSnippet>
                <MadCap:codeSnippetCopyButton />
                <MadCap:codeSnippetBody MadCap:useLineNumbers="False" MadCap:lineNumberStart="1" MadCap:continue="False" xml:space="preserve">mv kots kubectl-kots</MadCap:codeSnippetBody>
            </MadCap:codeSnippet>
            <p><code></code>
            </p>
        </ol>
        <ol MadCap:continue="true">
            <li>Move the <code>kubectl-kots</code> binary into your PATH so that it can be recognized by kubectl (e.g. /usr/local/bin/):</li>
            <MadCap:codeSnippet>
                <MadCap:codeSnippetCopyButton />
                <MadCap:codeSnippetBody MadCap:useLineNumbers="False" MadCap:lineNumberStart="1" MadCap:continue="False" xml:space="preserve">mv kubectl-kots /usr/local/bin/</MadCap:codeSnippetBody>
            </MadCap:codeSnippet>
            <p><code></code>
            </p>
        </ol>
        <h2>Install the Swimlane Application using KOTS</h2>
        <ol>
            <li>
                <p>Choose the namespace within which you will install the Swimlane Platform Installer (SPI) and Swimlane platform. These instructions will refer to this namespace as `your-namespace`.</p>
            </li>
            <li>
                <p>Download the offline installer package to your jumpbox:</p>
                <MadCap:codeSnippet>
                    <MadCap:codeSnippetCopyButton />
                    <MadCap:codeSnippetBody MadCap:useLineNumbers="False" MadCap:lineNumberStart="1" MadCap:continue="False" xml:space="preserve">https://get.swimlane.io/existing-cluster/install/offline-package</MadCap:codeSnippetBody>
                </MadCap:codeSnippet>
            </li>
        </ol>
        <ol MadCap:continue="true">
            <li>
                <p>Copy the offline installer package to the jumpbox.</p>
            </li>
            <li>
                <p>Upload the SPI container images to your private registry to prepare for installation into the Kubernetes cluster:</p>
            </li>
            <MadCap:codeSnippet>
                <codeSnippetCopyButton />
                <codeSnippetBody>kubectl kots admin-console push-images &lt;path-to-offline-installer-package&gt; &lt;your-registry-endpoint&gt;/&lt;your-registry-name&gt; \
  --registry-username &lt;your-registry-username&gt; \
  --registry-password &lt;your-registry-password&gt;
</codeSnippetBody>
            </MadCap:codeSnippet>
            <p>The upload can take several minutes.</p>
        </ol>
        <ol MadCap:continue="true">
            <li>Install the SPI pods:</li>
            <MadCap:codeSnippet>
                <codeSnippetCopyButton />
                <codeSnippetBody>kubectl kots install swimlane-platform \
  --kotsadm-registry &lt;your-registry-endpoint&gt;/&lt;your-registry-name&gt; \
  --registry-username &lt;your-registry-username&gt; \
  --registry-password &lt;your-registry-password&gt; \
  --namespace &lt;your-namespace&gt;
</codeSnippetBody>
            </MadCap:codeSnippet>
            <p>It will automatically create the namespace specified if it does not exist.</p>
            <li>
                <p>If the KUBECONFIG environment variable is not set you will need to add the following  to the install command above so that it can authenticate to your cluster:<br /></p>
                <MadCap:codeSnippet>
                    <MadCap:codeSnippetCopyButton />
                    <MadCap:codeSnippetBody MadCap:useLineNumbers="False" MadCap:lineNumberStart="1" MadCap:continue="False" xml:space="preserve">--kubeconfig /path/to/kube/config</MadCap:codeSnippetBody>
                </MadCap:codeSnippet>
            </li>
            <p>After a few moments of initialization it will prompt for what you want the SPI Admin Console password to be.</p>
            <p>
                <img src="../Resources/Images/admin_console_password.png" alt="" />
            </p>
        </ol>
        <ol MadCap:continue="true">
            <li>When the install is complete it will automatically proxy the SPI UI to http://localhost:8800.</li>
            <p>
                <img src="../Resources/Images/admin_console_forward.png" alt="" />
            </p>
            <p>In a Chrome browser window, access the SPI UI at http://localhost:8800 to begin configuring the Swimlane Platform.</p>
        </ol>
        <ol MadCap:continue="true">
            <li>Enter the password you specified during the install process.</li>
            <p>
                <img src="../Resources/Images/admin_console_login.png" alt="" />
            </p>
        </ol>
        <ol MadCap:continue="true">
            <li>Next, you are prompted to upload your .yaml license file. Select or drag the file, and then click <b>Upload license</b>.</li>
            <p>
                <img src="../Resources/Images/upload_license.png" alt="" style="max-width: 50%;" />
            </p>
        </ol>
        <ol MadCap:continue="true">
            <li>After the license is uploaded it will prompt you to confirm the private docker image registry settings.</li>
            <p>
                <img src="../Resources/Images/offline_confirm_registry_settings.png" alt="" style="max-width: 50%;" />
            </p>
            <p>Verify the information here is correct.</p>
            <p>Upload the airgap bundle.</p>
            <p>
                <img src="../Resources/Images/offline_upload_airgap_bundle.png" alt="" />
            </p>
            <p>The upload can take several minutes. After the upload is complete it extracts the bundle and pushes the Turbine platform images to your private docker image registry.</p>
        </ol>
        <ol MadCap:continue="true">
            <li>After the Turbine platform images are pushed to the private Docker image registry it will take you to the Config page opens. This is where you configure the Swimlane platform. See the <a href="configure-the-swimlane-platform-for-an-existing-cluster-install.htm">Configure the Swimlane Platform for an Existing Cluster Install</a> topic to configure and deploy Swimlane.</li>
        </ol>
    </body>
</html>